---
title: "Thesis"
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

```{r}
#| label: add-packages
library(tidyverse)
library(janitor)
library(tinytex)
library(tidymodels)
library(readxl)
```

```{r}
#| label: load-data
gen_con <- read_csv("data/gen_con_status.csv")
tmk <- read_csv("data/edited_tmk_annual_release_1.2.csv")
tmk_2 <- read_excel("data/tmk_events_release_1.2.xls")
```
```{r}
#| label: view-data

tmk_2_edit <- tmk_2 |>
  select(
    year, duration, tmk.ordinal, genpol.ongoing, genpol.onset, group1.tmk.rel, group1.tmk.eth, primary.location
    ) |>
  filter(group1.tmk.rel == 1 | group1.tmk.eth == 1) |>
  clean_names() |> mutate(primary_location = case_when(
  primary_location == "Soviet Union" ~ "Russia", 
  primary_location == "DRC Congo (Zaire)" ~ "DR Congo", 
  primary_location == "Myanmar (Burma)" ~ "Myanmar",
  primary_location == "Zanzibar" ~ "Tanzania",
  primary_location == "Bosnia-Herzegovina" ~ "Bosnia-Herzogovina",
  primary_location == "DR Congo (Zaire)" ~ "DR Congo",
  primary_location == "Russia (Soviet Union)" ~ "Russia",
  primary_location == "Serbia (Yugoslavia)" ~ "Serbia",
  primary_location == "Sudan, Chad" ~ "Sudan",
  primary_location == "India/Pakistan" ~ "India",
  primary_location == "Cambodia (Kampuchea)" ~ "Cambodia",
  TRUE ~ primary_location
  ))
                          
```

```{r}
#| label: join-data-2 

gen_2 <- gen_con |>
  left_join(tmk_2_edit, by = join_by(Participant == primary_location))
view(gen_2)
```


```{r}
#| label: clean-data
gen_2 <- gen_2 |>
  clean_names() |>
  mutate(
    state_system_membership_year = as.integer(
      state_system_membership_year),
    signatory_status = as.factor(signatory_status),
    signature_date = as.integer(signature_date),
    ratification_status = as.factor(ratification_status),
    in_effect_ix_reservation = as.factor(in_effect_ix_reservation),
    historical_reservation_made_to_article_ix_no_longer_in_effect = as.factor(historical_reservation_made_to_article_ix_no_longer_in_effect),
    ever_reserved = case_when(
    in_effect_ix_reservation == 1 | historical_reservation_made_to_article_ix_no_longer_in_effect == 1 ~ 1,
    in_effect_ix_reservation == 0 & historical_reservation_made_to_article_ix_no_longer_in_effect == 0 ~ 0)) |>
  filter(ratification_status == 1)

```

```{r}
gen_2 |>
  filter(ratification_year >= year) |>
  group_by(participant) |> 
  count()

tmk_priors <- gen_2 |>
  filter(ratification_year >= year) |>
  group_by(participant) |>
  summarize(sum = sum(tmk_ordinal))
  
tmk_priors

gen_2 <- gen_2 |> 
  mutate(sum_of_prior_tmks = case_when(
    participant == "Azerbaijan" ~ 1,
    participant == "Bangladesh" ~ 15,
    participant == "Bosnia-Herzogovina" ~ 5,
    participant == "Burundi" ~ 41, 
    participant == "China" ~ 15,
    participant == "Cyprus" ~ 1,
    participant == "DR Congo" ~ 9,
    participant == "India" ~ 26,
    participant == "Myanmar" ~ 1,
    participant == "Nigeria" ~ 24,
    participant == "Pakistan" ~ 12,
    participant == "Rwanda" ~ 8,
    participant == "Serbia" ~ 12,
    participant == "Sudan" ~ 90,
    participant == "Tanzania" ~ 2,
    participant == "Uganda" ~ 66,
    participant == "Zimbabwe" ~ 35,
    TRUE ~ 0
  ),
  ever_reserved = as.factor(ever_reserved))
```
```{r}
tmk_fit <- logistic_reg() |>
  fit(ever_reserved ~ sum_of_prior_tmks, data = gen_2)

tidy(tmk_fit)
  
```










